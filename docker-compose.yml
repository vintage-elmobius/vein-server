version: "3.8"

services:
  vein-server:
    image: ghcr.io/vintage-elmobius/vein-server:wip
    container_name: vein-server
    restart: unless-stopped

    environment:
      TZ: "America/New_York"

      # Server ports
      PORT: "7777"
      QUERY_PORT: "27015"

      # Server identity
      SERVER_NAME: "My Dockerized VEIN Server"
      SERVER_DESCRIPTION: "Its a server. That you can join."
      SERVER_PASSWORD: "password"
      MAX_PLAYERS: "8"

      # Admins
      SUPER_ADMIN_STEAM_IDS: "SteamID64"
      ADMIN_STEAM_IDS: ""

      # Visibility & networking
      SERVERLIST_VISIBLE: "True"
      BIND_ADDR: "0.0.0.0"
      VAC_ENABLED: "0"

      # HTTP API (loopback only)
      DASHBOARD_ENABLED: "true"
      DASHBOARD_PORT: "8443"

    volumes:
      - vein-data:/opt/server

    ports:
      - "7777:7777/udp"
      - "27015:27015/udp"

  vein-ui:
    image: ghcr.io/vintage-elmobius/vein-ui:wip
    container_name: vein-ui
    restart: unless-stopped

    # ðŸ”‘ THIS IS THE SIDE-CAR MAGIC
    network_mode: "container:vein-server"

    depends_on:
      - vein-server

    ports:
      - "8081:8081"

volumes:
  vein-data:
